# WiFi-CTF

WiFi-CTF is a container-based challenge environment designed for WiFi Capture The Flag (CTF) events. The project leverages Docker containers to create isolated WiFi testing environments, where each container is dynamically assigned simulated wireless hardware (PHY) interfaces. These environments mimic real-world WiFi networks, making it ideal for security competitions and educational challenges.

## Key Components

### mac80211_hwsim

**mac80211_hwsim** is a Linux kernel module designed for simulating wireless hardware (PHY) interfaces. By leveraging this module, users can create multiple virtual wireless interfaces that emulate real WiFi hardware behavior without requiring actual physical radios. Each virtual PHY interface generated by mac80211_hwsim behaves independently, supporting features such as association, authentication, encryption, and packet transmission—mirroring real-world WiFi interactions. This makes mac80211_hwsim invaluable for wireless testing, educational purposes, development, and Capture the Flag (CTF) environments.

**References:**

- [mac80211_hwsim - Linux Wireless Wiki](https://wireless.wiki.kernel.org/en/users/drivers/mac80211_hwsim)


### Linux Network Namespaces

**Network namespaces** are a powerful feature of the Linux kernel that enables the isolation of network resources within a single operating system instance. Each namespace maintains its own independent network interfaces, routing tables, firewall rules, and IP addresses, effectively creating multiple isolated network stacks on the same host. Namespaces facilitate secure and isolated network operations, essential for testing, development, security exercises, and containerized environments.

**References:**

- [Linux Network Namespaces (man7.org)](https://man7.org/linux/man-pages/man7/network_namespaces.7.html)
- [Linux Network Namespaces (wikipedia.org)](https://en.wikipedia.org/wiki/Linux_namespaces#Network_(net))

## How the Challenge Works

WiFi-CTF runs entirely on the server side. The system is pre-configured with the mac80211_hwsim module and utilizes Docker containers along with Linux network namespaces to orchestrate isolated, virtual WiFi environments. Here's how it all comes together:

1. **Server-Side Orchestration**  
   - The server manages a pool of virtual PHY interfaces and SSH ports.  
   - When a player (or admin) logs into the web interface, the system dynamically spawns a Docker container, assigns it a set of virtual radios (via mac80211_hwsim), and places these interfaces into an isolated network namespace.
   - Each container is configured with an SSH server and a unique port, allowing players to connect easily.

2. **Simplified Player Experience**  
   - **Players** log in through a user-friendly web interface without needing to install or configure any tools locally.
   - Once logged in, players can spawn their own container-based environment with just a click.  
   - The container’s details (such as IP:Port, credentials, and uptime) are displayed, and players can easily copy the SSH command to connect.

3. **Admin Panel**  
   - **Admins** log in with special credentials and gain access to a comprehensive admin panel where they can monitor all running containers, view statistics (such as available PHY interfaces and SSH port pool), and manage user accounts (add/edit credentials).
   - This centralized management helps streamline the orchestration of the CTF event.

## Key Advantages

- **Centralized, Server-Side Management:**  
  All configuration, container spawning, and network isolation are handled on the server. This allows players to jump straight into the challenge without worrying about setup or hardware compatibility.

- **Complete Isolation:**  
  By leveraging mac80211_hwsim and Linux network namespaces, each container gets its own isolated virtual wireless environment. This ensures that testing or interference in one container does not affect another.

- **Ease of Use:**  
  The web-based interface abstracts the underlying complexity. Both players and admins can focus on the challenge itself rather than on system configuration.

## Setup Process

Follow these steps to set up and run the WiFi-CTF project:

### 1. Prerequisites

- **Docker:**
- **Python 3.x:**
- **Linux Environment with the following tools:** aircrack-ng, iw, iproute2, net-tools

### 2. Clone the Repository

Clone the repository to your local machine:

```bash
git clone https://github.com/yourusername/WiFi-CTF.git
cd WiFi-CTF
```

### 3. Build the Docker Image

Navigate to the Docker directory and build the Docker image:

```bash
cd Docker
sudo docker build -t ngdsa-wifi-ctf .
```

### 4. Initiate kernel module mac80211_hwsim
In this challenge, we use 60 virtual radios, assigning 3 to each Docker container, allowing up to 20 players in total. Although the kernel module supports up to 100 virtual radios, we limited the number due to hardware limitations.

```bash
sudo modprobe mac80211_hwsim radios=60
```

### 5. Install requirements.txt
Navigate to the WebApp directory, create a python virtual environment and install the required packages:
```bash
cd ../WebApp
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### 6. Configure and Run the Flask App
For security reasons and better customization, modify the following environment variables in `app.py`. Afterward, start the web app and access the login page and panels via the IP and port displayed.

- `app.secret_key = 'secret_key'` Random key of your choice

- `USERS = {"admin": "admin"}` "username" : "password"

```bash
sudo python app.py
```

### Alternatively:

**After step 4**, you can run the `run_container.sh` script to manually spawn containers for testing. You'll need to identify the SSH port and manually stop the containers afterward, but the cleanup process itself is automated.

```bash
chmod +x run_container.sh
sudo ./container.sh
sudo docker ps
sudo docker stop <container_name>
```

# Author
*shameless plug :>*

[DENNISDGR](https://github.com/DENNISDGR)

# License
[GNU General Public License v3.0](https://github.com/NGDSA-Lab/WiFi-CTF/blob/main/LICENSE)